#!/bin/bash

# instdeb: script to install local deb(s) with dependencies from filemanager
# by gumanzoy https://github.com/PocketHandyBox

if [ -z `which gsu` ]; then
[ "`whoami`" != "root" ] && exec gksu ${0} "$@"
else
[ "`whoami`" != "root" ] && exec gsu ${0} "$@"
fi

export DEBS="$@"
export DEBSNAME="$(for DEB in `basename -a $DEBS`; do echo -n $DEB' '; done)"

apt_install() {
echo -e "instdeb \E[33m$DEBSNAME"
echo -e "\E[32m\nInstallation starting . . ."
tput sgr0
APT_ERRMSG=`apt-get -s -y --allow-downgrades install $DEBS`
if [ "$?" = 0 ]; then
	apt --allow-downgrades install $DEBS
	[ "$?" = 0 ] && echo -en "\nDeb(s): \E[32m$DEBSNAME\n\033[1m\nInstalled. "
else
	echo "$APT_ERRMSG"
	echo -en "\nExit. "
fi
read -s -n 1 -p "Press any key to close . . ."
}
export -f apt_install

xterm +aw -T instdeb -e /bin/bash -c apt_install
